<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <!-- Enable central package management -->
    <ManagePackageVersionsCentrally>true</ManagePackageVersionsCentrally>
    <!-- Enable deterministic NuGet package restore -->
    <RestoreLockedMode>true</RestoreLockedMode>
    <RestorePackagesWithLockFile>true</RestorePackagesWithLockFile>
    <RestoreUseStaticGraphEvaluation>true</RestoreUseStaticGraphEvaluation>
  </PropertyGroup>

  <ItemGroup Label="PackageVersions">
    <!-- MTGOSDK -->
		<PackageVersion Include="Microsoft.CSharp"
                    Version="4.7.0" />
    <PackageVersion Include="System.Reflection.Emit.Lightweight"
                    Version="4.7.0" />
    <PackageVersion Include="Microsoft.Diagnostics.Runtime"
                    Version="3.1.512801" />
    <PackageVersion Include="ImpromptuInterface"
                    Version="8.0.4" />
    <PackageVersion Include="Newtonsoft.Json"
                    Version="13.0.3" />
    <!-- MTGOSDK.MSBuild -->
    <PackageVersion Include="Microsoft.Build.Utilities.Core"
                    Version="17.0.0" />
    <PackageVersion Include="JetBrains.Refasmer"
                    Version="1.0.33" />
    <PackageVersion Include="Microsoft.ILVerification"
                    Version="8.0.0" />
    <!-- MTGOSDK.Win32 -->
    <PackageVersion Include="Microsoft.Win32.Registry"
                    Version="5.0.0" />
    <!-- third_party/ScubaDiver -->
    <PackageVersion Include="Microsoft.Bcl.AsyncInterfaces"
                    Version="8.0.0" />
    <PackageVersion Include="System.Runtime.CompilerServices.Unsafe"
                    Version="6.0.0" />
    <!-- third_party/SharpNeedle -->
    <PackageVersion Include="MSVCToolchain"
                    Version="1.0.1" />
  </ItemGroup>

  <!-- .NET Standard 2.0 -->
  <ItemGroup Condition="'$(TargetFramework)' == 'netstandard2.0'">
    <!-- Use API polyfills to help write .NET 5.0+ compatible code -->
    <GlobalPackageReference Include="Meziantou.Polyfill"
                            Version="1.0.37"
                            PrivateAssets="all"
                            Condition="'$(EnablePolyfills)' != 'false'" />
  </ItemGroup>

  <!-- .NET Framework 2.0+ -->
  <ItemGroup Condition="'$(TargetFramework.TrimEnd(`0123456789.`))' == 'net'">
    <!-- Prefer reference assemblies to help produce deterministic builds -->
    <GlobalPackageReference Include="Microsoft.NETFramework.ReferenceAssemblies"
                            Version="1.0.3"
                            PrivateAssets="all" />
  </ItemGroup>

  <!-- Build-time dependencies for MTGOSDK.MSBuild -->
  <ItemGroup Condition="'$(ILRepackTargetsFile)' != ''">
    <GlobalPackageReference Include="ILRepack"
                            Version="2.0.31"
                            PrivateAssets="all" />
    <GlobalPackageReference Include="ILRepack.Lib.MSBuild.Task"
                            Version="2.0.31"
                            PrivateAssets="all" />
  </ItemGroup>

  <!--
    SourceLink: Use ReproducibleBuilds SDK for build determinism.
    - https://github.com/dotnet/reproducible-builds
  -->
  <Sdk Name="DotNet.ReproducibleBuilds.Isolated"
       Version="1.1.1"
       Condition="'$(EnableSourceLink)' != 'false'" />
  <ItemGroup Condition="'$(EnableSourceLink)' != 'false'">
    <GlobalPackageReference Include="DotNet.ReproducibleBuilds"
                            Version="1.1.1"
                            PrivateAssets="All" />
    <!--
      Required for deterministic source paths.
      - https://github.com/dotnet/roslyn/issues/55860
    -->
    <SourceRoot Include="$([MSBuild]::EnsureTrailingSlash($(RepoRoot)))"
                Condition="'$(RepoRoot)' != ''" />
    <GlobalPackageReference Include="Microsoft.SourceLink.GitHub"
                            Version="8.0.0"
                            PrivateAssets="All" />
  </ItemGroup>

  <!-- Use Nerdbank.GitVersioning for package SemVer -->
  <ItemGroup Condition="'$(IsPackable)' != 'false' And
                        '$(EnableSourceControlManagerQueries)' != 'false'">
    <GlobalPackageReference Include="Nerdbank.GitVersioning"
                            Version="3.6.133"
                            PrivateAssets="All" />
  </ItemGroup>

</Project>