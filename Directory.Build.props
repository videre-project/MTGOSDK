<Project>

  <!-- Project Directories -->
  <PropertyGroup>
    <SolutionDir>$(MSBuildThisFileDirectory)</SolutionDir>
    <DistDir>$(SolutionDir)\dist</DistDir>
    <PublishDir>$(SolutionDir)\publish</PublishDir>
  </PropertyGroup>

  <!-- Internal SDK Paths -->
  <PropertyGroup>
    <UseFullSDKPaths>true</UseFullSDKPaths>
    <MTGOSDKCoreTFM>netstandard2.0</MTGOSDKCoreTFM>
    <MTGOSDKCoreTarget>.NETStandard2.0</MTGOSDKCoreTarget>
    <MTGOSDKCorePath>$(SolutionDir)\MTGOSDK\bin\$(Configuration)\$(MTGOSDKCoreTFM)</MTGOSDKCorePath>
    <PackageOutputPath>$(PublishDir)</PackageOutputPath>
  </PropertyGroup>

  <!-- Disable SourceLink for C++ projects -->
  <PropertyGroup Condition="'$(MSBuildProjectExtension)' == '.vcxproj'">
    <EnableSourceLink>false</EnableSourceLink>
    <!-- Override any SourceLink queries for (unsupported) C++ projects. -->
    <SuppressImplicitGitSourceLink>true</SuppressImplicitGitSourceLink>
    <EnableSourceControlManagerQueries>false</EnableSourceControlManagerQueries>
    <!-- Disable NuGet restore as it is not supported for C++ projects. -->
    <ResolveNugetPackages>false</ResolveNugetPackages>
  </PropertyGroup>

  <!--
    SourceLink: Package Properties
    https://devblogs.microsoft.com/dotnet/producing-packages-with-source-link/
  -->
  <PropertyGroup Condition="'$(EnableSourceLink)' != 'false'">
    <PublishRepositoryUrl>true</PublishRepositoryUrl>
    <EmbedUntrackedSources>true</EmbedUntrackedSources>
    <!-- Build a separate snupkg symbol package for NuGet. -->
    <IncludeSymbols>True</IncludeSymbols>
    <SymbolPackageFormat>snupkg</SymbolPackageFormat>
  </PropertyGroup>

  <!-- Continuous Integration -->
  <PropertyGroup Condition="'$(Configuration)' == 'Release'">
    <ContinuousIntegrationBuild>true</ContinuousIntegrationBuild>
  </PropertyGroup>
  <ItemGroup Condition="'$(ContinuousIntegrationBuild)' == 'true'">
    <!--
      Required for deterministic source paths.
      Refer to https://github.com/dotnet/roslyn/issues/55860
    -->
    <SourceRoot Include="$([MSBuild]::EnsureTrailingSlash($(RepoRoot)))"
                Condition="'$(RepoRoot)' != ''" />
    <PackageReference Include="Microsoft.SourceLink.GitHub"
                      PrivateAssets="All"
                      Condition="'$(EnableSourceLink)' != 'false'" />
  </ItemGroup>

  <!-- SourceLink: ReproducibleBuilds SDK -->
  <Sdk Name="DotNet.ReproducibleBuilds.Isolated"
       Version="1.1.1"
       Condition="'$(EnableSourceLink)' != 'false'" />
  <ItemGroup>
    <PackageReference Include="DotNet.ReproducibleBuilds"
                      PrivateAssets="All"
                      Condition="'$(EnableSourceLink)' != 'false'" />
  </ItemGroup>

</Project>